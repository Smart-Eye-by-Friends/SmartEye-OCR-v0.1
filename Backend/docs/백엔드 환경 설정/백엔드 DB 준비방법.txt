• DB 준비 절차

  - Backend/docker-compose.yml:3 의 mysql 서비스는 포트를 ${MYSQL_PORT:-3308}:3306 으로 매핑하므로 Backend/.env.docker 의 기본
    값(3308)을 그대로 쓰면 호스트에서 127.0.0.1:3308 로 접근한다.
  - 컨테이너 실행: docker compose -f Backend/docker-compose.yml --env-file Backend/.env.docker up -d mysql
    (이미 띄워져 있다면 docker ps 로 상태만 확인).
  - 백엔드가 같은 컨테이너를 사용하려면 .env 또는 환경 변수에 DB_HOST=127.0.0.1, DB_PORT=3308, DB_USER=root,
    DB_PASSWORD=1q2w3e4r, DB_NAME=smarteyessen_db 를 명시한다 (Backend/.env.example 참고).

  스키마 초기화

  - Project/DB/erd_schema.sql:58 은 DROP DATABASE 후 전체 12개 테이블을 다시 생성하므로 실행 전 기존 데이터 백업을 권장한다.
  - 스키마 적용:

    docker exec -i smart_mysql \
      mysql -uroot -p'1q2w3e4r' \
      < Project/DB/erd_schema.sql
    (스크립트가 내부에서 USE smarteyessen_db 를 수행).
  - 완료 후 확인:

    docker exec -it smart_mysql \
      mysql -uroot -p'1q2w3e4r' smarteyessen_db \
      -e "SHOW TABLES;"

  기본 데이터 시드

  - 테스트용 사용자/문서 타입만 필요한 경우 Backend/scripts/seed_test_data.sql 을 적용한다.

    docker exec -i smart_mysql \
      mysql -uroot -p'1q2w3e4r' smarteyessen_db \
      < Backend/scripts/seed_test_data.sql
  - SELECT user_id, email FROM users; 와 SELECT doc_type_id, type_name FROM document_types; 로 삽입 여부를 확인한다.

  백엔드 연결 검증

  - 가상환경에서 pip install -r Backend/requirements.txt 후 python -m Backend.app.database 를 실행하면 test_connection() 결과가
    출력된다 (Backend/app/database.py:119).
  - 서버 기동:

    uvicorn Backend.app.main:app --reload --host 0.0.0.0 --port 8000
    시작 로그에 ✅ Database connection successful 과 ✅ Database tables initialized 가 보이면 연결 성공.
  - 런타임 헬스 체크: curl http://localhost:8000/health → 응답의 "database": "connected" 여부 확인.

  파이프라인 테스트 방법

  - 프로젝트 생성 → 단일 이미지 업로드 → 비동기 분석 → 상태 폴링 순으로 REST 엔드포인트를 호출한다 (Backend/app/routers/
    pages.py:49, Backend/app/routers/analysis.py:45).
  - 다중 이미지 또는 PDF(application/pdf) 업로드 후 POST /api/projects/{project_id}/analyze 로 배치 파이프라인을 호출하면
    page_results 에 처리 요약이 담긴다.
  - DB 검증 쿼리 예시:

    SELECT page_id, analysis_status FROM pages WHERE project_id = ?;
    SELECT COUNT(*) FROM layout_elements WHERE page_id = ?;
    SELECT version_type FROM text_versions WHERE page_id = ? ORDER BY version_number DESC;
  - OpenAI 설명을 테스트할 경우 .env 의 OPENAI_API_KEY 와 요청 본문 use_ai_descriptions=true 를 함께 지정한다.

  문제 해결 팁

  - 스키마 재생성 후에도 테이블이 보이지 않으면 볼륨(smart_mysql_data)을 삭제 후 다시 docker compose up 으로 마운트한다.
  - 포트 충돌 시 Backend/.env.docker 의 MYSQL_PORT 값을 바꾼 뒤 컨테이너를 재기동하고 .env 도 동일하게 맞춘다.
  - OCR/모델 로딩 실패는 백엔드 로그(loguru)에 경로·모델 키를 남기므로 tail -f 로 추적하면서 해결한다.