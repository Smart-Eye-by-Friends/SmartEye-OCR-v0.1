## **🎯 명확한 서비스 목적**

### **한 문장 요약**

> "아동 학습지를 페이지별로 분석하고, 사용자가 포맷팅된 텍스트를 직접 수정한 뒤, 최종 수정본들을 하나의 문서로 통합하여 다운로드할 수 있는 시각 장애 아동용 학습 자료 생성 서비스"

---

### **세부 목적 분석**

### **A. 문제 상황**

```
❌ 기존 문제점:
- 시각 장애 아동은 종이 학습지를 읽을 수 없음
- 단순 OCR 결과는 오류가 많고 구조가 엉망
- 그림/표는 텍스트로 설명이 필요함
- 여러 페이지를 개별적으로만 처리 가능

```

### **B. 해결 방안**

```
✅ 제공하는 솔루션:
1. AI 레이아웃 분석으로 문서 구조 파악
2. OCR + AI 설명으로 전체 내용 추출
3. 자동 포맷팅으로 읽기 쉬운 구조 생성
4. 사용자가 직접 수정하여 정확도 향상
5. 다중 페이지 통합으로 완전한 학습 자료 생성

```

---

## 전체 화면 구조

```html
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│ HEADER │ │ 🔍 SmartEyeSsen 학습지 분석 │ │ AI 기반 학습지 OCR 및 구조 분석
시스템 │ │ 배경: #00BCD4 | 높이: 80px | 텍스트: 흰색 │
└─────────────────────────────────────────────────────────────────────────────────────────────┘
┌──────────┬──────────────┬──────────────────────────────┬──────────────────────────────┐
│ SIDEBAR │ 페이지 슬라이드│ 레이아웃 분석 탭 │ 텍스트 수정 탭 │ │ (200px) │
(250px) │ (flex 50%) │ (flex 50%) │
├──────────┼──────────────┼──────────────────────────────┼──────────────────────────────┤
│ │ │ │ │ │ ⭐ │ 📄 페이지 │ 📊 레이아웃 분석 │ 📋 텍스트 추출 │ │ 분석 설정│
(0) │ ────────────────── │ ─────────────── │ │ │ │ │ │ │ ──── │ ┌──────────┐│ [◀
이전] [1/0] [다음 ▶] │ 🔍 레이아웃 분석 │ │ │ │ 📁 ││ [🔍-] 100% [🔍+] │ 📊 분석
통계 │ │ 🧠 AI │ │ ││ [원본][맞춤][확대][축소] │ 📝 텍스트 변환 │ │ 모델 │ │
페이지 ││ ────────────────── │ 🎨 AI 설명 │ │ 선택 │ │ 이미지 ││ │ 📋 문제별
정리 │ │ │ │ 추가 ││ ┌────────────────────────┐ │ ─────────────── │ │ ──── │ │
││ │ │ │ │ │ │ │ 이미지 ││ │ │ │ 📷 │ │ 📝 │ │ 또는 PDF ││ │ [이미지 뷰어 영역]
│ │ │ │ 문서 │ │ 드래그 ││ │ │ │ 분석 결과가 │ │ 타입 │ │ 또는 ││ │ - 확대/축소
가능 │ │ 없습니다 │ │ 🆕 │ │ 클릭하여 ││ │ - 드래그 이동 가능 │ │ │ │ │ │ 추가
││ │ - 마우스 휠 줌 │ │ 왼쪽에서 이미지를 │ │ ⚪ │ └──────────┘│ │ │ │
업로드하고 │ │ 문제지 │ │ │ │ │ 분석을 │ │ (학습지, │ 배경: #E0F7FA│ │ │ │
시작해주세요 │ │ 시험지) │ 높이: 120px │ │ │ │ │ │ │ │ │ │ │ 배경: #FAFAFA │ │
⚫ │ ┌──────────┐│ │ │ │ 텍스트: #757575 │ │ 일반 │ │ (페이지 ││
└────────────────────────┘ │ │ │ 문서 │ │ 없음) ││ │ │ │ (논문, │ └──────────┘│
배경: #FAFAFA │ │ │ 신문 등)│ │ │ │ │ │ │ │ │ │ ──── │ │ │ │ │ │ │ │ │ │ 🤖 │ │
│ │ │ 분석 │ ┌──────────┐│ │ │ │ 모델 │ │ ◀ ▶ ││ │ │ │ │ │페이지 ││ │ │ │ 문제지
│ │네비게이션││ │ │ │ 모델: │ └──────────┘│ │ │ │ SmartEye │ │ │ │ │ Ssen │ │ │
│ │ │ │ │ │ │ 일반 │ │ │ │ │ 모델: │ │ │ │ │ DocLayout│ │ │ │ │ -YOLO │ │ │ │ │
│ │ │ │ │ ──── │ │ │ │ │ │ │ │ │ │ 📄 │ │ │ │ │ 분석 │ │ │ │ │ 모드 │ │ │ │ │ │
│ │ ┌──────┐ ┌─────────────┐ │ │ ⚪ │ │ │ │ 저장 │ │ 다음 페이지 │ │ │ CIM 통합
│ │ │ └──────┘ └─────────────┘ │ │ 분석 │ │ │ │ │ (권장) │ │ │ 배경: #2196F3 │ │
│ │ │ 우측 하단 고정 │ │ ⚫ │ │ │ │ │ 기본 │ │ │ │ │ 분석 │ │ │ │ │ (레거시) │ │
│ │ │ │ │ │ │ │ ──── │ │ │ │ │ │ │ │ │ │ 🔑 │ │ │ │ │ OpenAI │ │ │ │ │ API 키 │
│ │ │ │ (선택 │ │ │ │ │ 사항) │ │ │ │ │ │ │ │ │ │[••••••] │ │ │ │ │ │ │ │ │ │
──── │ │ │ │ │ │ │ │ │ │ ┌──────┐│ │ │ │ │ │ 🚀 ││ │ │ │ │ │ 분석 ││ │ │ │ │ │
시작 ││ │ │ │ │ └──────┘│ │ │ │ │ │ │ │ │ │ ┌──────┐│ │ │ │ │ │ 📦 ││ │ │ │ │ │
통합 ││ │ │ │ │ │다운로드││ │ │ │ │ └──────┘│ │ │ │ │ │ │ │ │
└──────────┴──────────────┴──────────────────────────────┴──────────────────────────────┘
```

## **1️⃣ 문제지 vs 일반 문서: 정렬 및 포맷팅 규칙**

### **A. 정렬 방식의 차이**

### **문제지 전용 포맷팅 규칙**

```python
worksheet_formatting_rules = {
    'question_number': {
        'prefix': '\\n\\n',        # 문제 간 간격
        'suffix': '. ',
        'font_weight': 'bold',
        'font_size': '14pt'
    },
    'question_text': {
        'prefix': '   ',          # 3칸 들여쓰기
        'suffix': '\\n',
        'indent': 3
    },
    'choices': {
        'prefix': '   ',          # 선택지 들여쓰기
        'suffix': '\\n',
        'indent': 3,
        'format': 'multiple_choice'  # ①, ②, ③ 형식
    },
    'passage': {
        'prefix': '\\n   [지문]\\n   ',
        'suffix': '\\n',
        'indent': 3,
        'background': 'light_gray'
    },
    'figure': {
        'prefix': '\\n   [그림 설명]\\n   ',
        'suffix': '\\n',
        'indent': 3
    }
}

```

**특징:**

- **문제 구조 강조**: 번호, 지문, 선택지 구분 명확
- **들여쓰기 중심**: 계층 구조 시각화

---

### **일반 문서 전용 포맷팅 규칙**

```python
document_formatting_rules = {
    'title': {
        'prefix': '',
        'suffix': '\\n\\n',
        'font_weight': 'bold',
        'font_size': '18pt',
        'align': 'center'
    },
    'heading': {
        'prefix': '\\n',
        'suffix': '\\n\\n',
        'font_weight': 'bold',
        'font_size': '16pt'
    },
    'paragraph': {
        'prefix': '',
        'suffix': '\\n\\n',
        'line_spacing': '1.5',
        'text_align': 'justify'  # 양쪽 정렬
    },
    'list': {
        'prefix': '• ',           # 불릿 포인트
        'suffix': '\\n',
        'indent': 2
    },
    'figure': {
        'prefix': '\\n[그림 ',     # 그림 번호 자동 생성
        'suffix': ']\\n\\n',
        'numbering': 'auto'       # 그림 1, 그림 2...
    },
    'table': {
        'prefix': '\\n[표 ',       # 표 번호 자동 생성
        'suffix': ']\\n\\n',
        'numbering': 'auto'
    },
    'footnote': {
        'prefix': '\\n* ',
        'suffix': '\\n',
        'font_size': '10pt'
    }
}

```

**특징:**

- **문서 구조 강조**: 제목, 소제목, 본문 구분
- **가독성 중심**: 줄 간격, 양쪽 정렬

---

## **2️⃣ 모델 선택으로 문서 타입 구분**

---

### **C. 사용자 시나리오**

### **시나리오 1: 수학 문제지 분석**

```
사용자 행동:
1. 사이드바에서 "📝 문제지" 선택
2. 자동으로 "SmartEyeSsen" 모델 선택됨
3. 이미지 업로드
4. "🚀 분석 시작" 버튼 클릭

시스템 동작:
1. SmartEyeSsen 모델로 레이아웃 분석
2. 문제 번호 감지 및 그룹핑
3. 문제지 전용 포맷팅 규칙 적용
4. TinyMCE에 문제 순서대로 정렬된 텍스트 표시

결과:
┌─────────────────────────────────────┐
│  📊 분석 완료                        │
├─────────────────────────────────────┤
│  문서 타입: 📝 문제지                │
│  사용 모델: SmartEyeSsen             │
│  감지된 문제: 5개                    │
│  포맷팅 규칙: 문제지 전용            │
└─────────────────────────────────────┘

TinyMCE:
───────────────────────────────
1. 다음 이차방정식을 풀어라.
   x² - 5x + 6 = 0

   ① 2, 3
   ② 1, 4

2. ...
───────────────────────────────

```

---

### **시나리오 2: 논문 분석**

```
사용자 행동:
1. 사이드바에서 "📄 일반 문서" 선택
2. 자동으로 "DocLayout-YOLO" 모델 선택됨
3. PDF 업로드
4. "🚀 분석 시작" 버튼 클릭

시스템 동작:
1. DocLayout-YOLO 모델로 레이아웃 분석
2. Y/X 좌표 기준 정렬 (읽는 순서)
3. 일반 문서 전용 포맷팅 규칙 적용
4. TinyMCE에 문서 구조대로 정렬된 텍스트 표시

결과:
┌─────────────────────────────────────┐
│  📊 분석 완료                        │
├─────────────────────────────────────┤
│  문서 타입: 📄 일반 문서             │
│  사용 모델: DocLayout-YOLO           │
│  문서 구조: 제목(1) 소제목(3)        │
│             본문(12) 그림(2)         │
│  포맷팅 규칙: 일반 문서 전용         │
└─────────────────────────────────────┘

TinyMCE:
───────────────────────────────
인공지능 기반 문서 분석 시스템

저자: 홍길동, 김철수

초록
본 연구는...

서론
최근 인공지능 기술의...

[그림 1] 시스템 구조도

본론
...
───────────────────────────────

```

---

### **D. 모델별 특화 기능**

### **SmartEyeSsen (문제지 전용 모델)**

**특화 기능:**

- 문제 번호 감지 정확도 높음
- 선지/선택지 구분 명확
- 그림-문제 관계 파악
- 단답형/서술형/객관식 구분

**감지 클래스:**

```
- title (제목, ocr)
- figure (그림, AI설명)
- table (표, AI설명)
- unit(단원명, ocr)
- question type(문제 유형, ocr)
- question text(문제 본문, ocr)
- question number(문제 번호, ocr)
- list(목록, ocr)
- choices(선택지, ocr)
- page(페이지 번호, ocr)
- underline_blank
- parenthesis_blank
- grid_blank
- box_blank
- second_question_number(서브 문제 번호, ocr)
- flowchart(flowchart, AI설명)
```

---

### **DocLayout-YOLO (일반 문서 전용 모델)**

**특화 기능:**

- 제목/소제목 계층 구조 파악
- 단락 구분 명확
- 그림/표 캡션 인식
- 각주/참고문헌 구분

**감지 클래스:**

```
- title (제목, ocr)
- plain text (본문 텍스트, ocr)
- abandon (폐기 텍스트)
- figure (그림, AI설명)
- figure_caption (그림 캡션, ocr)
- table (표, AI설명)
- table caption (표 캡션, ocr)
- table footnote (표 각주, ocr)
- isolate_formula (독립 수식, ocr)
- formula_caption (수식 캡션, ocr)
```

---

## **🎯 최종 사용자 경험 흐름 (모델 선택 방식)**

### **케이스 1: 문제지 분석**

```
1. 사용자: 사이드바에서 "📝 문제지" 선택
   ↓
2. 시스템: SmartEyeSsen 모델 자동 선택
   ↓
3. 사용자: 수학 문제지 이미지 업로드
   ↓
4. 사용자: "🚀 분석 시작" 클릭
	 백엔드가 DocLayout-YOLO + OCR + AI로 분석
   ↓
5. 시스템:
   - 문제 번호 감지 (1, 2, 3, 4, 5)
   - 각 문제별 요소 그룹핑
   - '문제 순서대로 정렬'
   - '문제지 전용 포맷팅' 적용
   ↓
6. TinyMCE에 표시:
   "1. 다음 이차방정식을...
       ① 2, 3
       ② 1, 4
    2. 다음 그림에서..."
   ↓
7. 사용자: 텍스트 수정 및 저장
   사용자가 TinyMCE에서 직접 텍스트 편집
   (오타 수정, 문장 다듬기, 내용 추가/삭제)
   ↓
8. 반복: 페이지 2, 3, 4...
   ↓
9. 사용자: 헤더의 "📥 통합 다운로드" 클릭
   ↓
10. 시스템: 모든 페이지의 최신 수정본 합쳐서 워드 문서 생성
    ↓
11. 완료! 🎉
```

---

### **케이스 2: 일반 문서 분석**

```
1. 사용자: 사이드바에서 "📄 일반 문서" 선택
   ↓
2. 시스템: DocLayout-YOLO 모델 자동 선택
   ↓
3. 사용자: 논문 PDF 업로드
   ↓
4. 사용자: "🚀 분석 시작" 클릭
	 백엔드가 DocLayout-YOLO + OCR + AI로 분석
   ↓
5. 시스템:
   - Y/X 좌표 기준 정렬 (읽는 순서)
   - 제목/소제목/본문 구분
   - 그림/표 번호 자동 생성
   - '일반 문서 전용 포맷팅' 적용
   ↓
6. TinyMCE에 표시:
   "인공지능 기반 문서 분석 시스템

    저자: 홍길동, 김철수

    초록
    본 연구는...

    [그림 1] 시스템 구조도"
   ↓
7. 사용자: 텍스트 수정 및 저장
   사용자가 TinyMCE에서 직접 텍스트 편집
   (오타 수정, 문장 다듬기, 내용 추가/삭제)
   ↓
8. 반복: 페이지 2, 3, 4...
   ↓
9. 사용자: 헤더의 "📥 통합 다운로드" 클릭
   ↓
10. 시스템: 모든 페이지의 최신 수정본 합쳐서 워드 문서 생성
    ↓
11. 완료! 🎉
```
